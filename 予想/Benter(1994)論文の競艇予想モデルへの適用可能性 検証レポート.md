# Benter(1994)論文の競艇予想モデルへの適用可能性 検証レポート

## 1. はじめに

本レポートは、William Benter氏が1994年に発表した画期的な論文「Computer Based Horse Race Handicapping and Wagering Systems」で提示された統計的ベッティング手法を、我々の競艇予想AIプロジェクトに適用可能か検証することを目的とします。Benter氏のモデルは、香港競馬市場において長期的に有意な利益を上げたことが報告されており、その理論的基盤はパリミュチュエル方式の公営競技全般に応用できる可能性を秘めています。

## 2. Benterモデルの核心的手法

Benterモデルの根幹は、単なる「勝者予測」ではなく、**市場（大衆）のオッズが示す確率と、モデルが独自に算出する「真の確率」との歪み、すなわち「バリュー」を発見する**ことにあります。これは、以下の2段階の確率推定モデルによって実現されます。

### ステージ1: ファンダメンタルモデル (Fundamental Model)

まず、選手の能力、モーター性能、コース特性といった、レース結果に影響を与える**本質的な（ファンダメンタルな）要因**のみを用いて、各艇の「真の勝率」を推定します。論文では、この推定に**多項ロジットモデル (Multinomial Logit Model)** が用いられています。

> **競艇におけるファンダメンタル要因の例**
> - **選手要因**: 全国勝率、当地勝率、ST（スタートタイミング）
> - **モーター要因**: 2連対率、3連対率
> - **レース条件要因**: 枠番、競艇場、風速・風向き、水面状態

### ステージ2: 統合モデル (Combined Model)

次に、ファンダメンタルモデルが算出した確率 (`f_i`) と、大衆の投票によって形成されるオッズから逆算した確率 (`π_i`) を、以下の式を用いて統合し、最終的な勝率 (`c_i`) を算出します。

```
c_i = exp(α・f_i + β・π_i) / Σexp(α・f_j + β・π_j)
```

ここで `α` と `β` は、過去のデータから最尤法によって推定されるパラメータです。この統合モデルの重要な点は、**ファンダメンタルモデルが大衆のオッズに対してどれだけ「追加情報」を提供しているか（ΔR²）**を定量的に評価できることです。この追加情報こそが、利益の源泉となります。

## 3. 賭け金決定戦略：Kelly基準

Benterモデルは、どの艇に賭けるかだけでなく、**いくら賭けるべきか**についても数学的な指針を与えます。算出した最終勝率 (`c`) とオッズ (`div`) から期待リターン (`er`) を計算し、それが1を上回る（つまり期待値がプラスの）買い目に対して、**Kelly基準**を用いて最適な投資額を決定します。

- **期待リターン**: `er = c × div`
- **アドバンテージ**: `advantage = er - 1`
- **Kelly賭け率**: `K = advantage / (div - 1)`

論文では、リスク管理の観点から、算出された賭け率をさらに割り引く**分数Kelly (Fractional Kelly)**（例: 1/2 Kelly）の採用を強く推奨しています。

## 4. 競艇プロジェクトへの具体的な適用計画

Benterモデルを我々のプロジェクトに導入するため、以下の4段階の検証・実装計画を提案します。

### フェーズ1: データ準備と特徴量エンジニアリング

- **データソース**: プロジェクトのPostgreSQLデータベースに格納されている`historical_programs`（番組表）、`historical_race_results`（競走結果）、`historical_payoffs`（払戻金）の過去20年分のデータを活用します。
- **課題**: 仕様書で指摘されている通り、`historical_payoffs`テーブルのデータが不完全であるため、これを補完する作業が最優先となります。
- **特徴量作成**: 上記「ファンダメンタル要因の例」で挙げたような、競艇特有の多数の特徴量をデータベースから抽出し、モデルの入力データとして整備します。

### フェーズ2: ファンダメンタルモデルの構築

- Pythonの統計ライブラリ（`statsmodels`など）を用いて、多項ロジットモデルを構築します。
- 目的変数を「レースの勝者」、説明変数をフェーズ1で作成した特徴量群とします。
- モデルの予測精度を、論文で用いられている`R²`値で評価します。

### フェーズ3: 統合モデルの構築と評価

- ファンダメンタルモデルの予測結果と、レース直前のオッズデータを統合するモデルを構築します。
- 過去データを用いてパラメータ `α`, `β` を推定し、統合モデルがファンダメンタルモデル単体や大衆オッズ単体に比べて、どれだけ予測精度を向上させるか（`ΔR²`）を測定します。

### フェーズ4: バックテスト・シミュレーション

- 過去数年間（例: 2020年〜現在）のデータをテストデータとし、構築した統合モデルと分数Kelly戦略を用いたベッティングのシミュレーションを実行します。
- 単勝だけでなく、Harvilleの公式（バイアス補正版）を用いて2連単・3連単などの連勝式舟券にも対象を拡大します。
- シミュレーション結果を評価し、最終的な回収率（ROI）と資産の成長曲線を確認します。

## 5. 結論

Benter(1994)論文で提示された手法は、単なる勘や経験則に頼るのではなく、統計的優位性に基づいて利益を追求する、極めて高度かつ体系的なアプローチです。その理論的骨子は競艇にも完全に適用可能であり、我々のプロジェクトが目指す「回収率100%超え」を実現するための、最も有望なフレームワークであると結論付けられます。

上記の実装計画に沿って検証を進めることで、Benterモデルの有効性を具体的に証明できると確信しています。

## 6. 参考文献

[1] Benter, W. (1994). Computer Based Horse Race Handicapping and Wagering Systems: A Report. *Efficiency of Racetrack Betting Markets*, 183-198.
