## 競艇予想AIプロジェクト 検討仕様書（2026年1月10日版）

### 1. はじめに

本仕様書は、競艇予想AIプロジェクトの継続可否を判断するための材料として、現状の課題、今後の選択肢、およびそれに伴うコストを整理し、提言するものです。

前回の分析では、**現在収集済みのデータ（約6日間）のみでも回収率100%を超える勝ち筋の存在が確認**されており、プロジェクトは継続する価値が十分にあると結論付けています。本仕様書では、その勝ち筋をさらに強固なものにするための具体的な方針を提示します。

### 2. 結論：プロジェクトは継続すべきか？

**結論として、プロジェクトは継続すべきです。**

理由は以下の2点です。

1.  **勝ち筋の存在**: 単純な戦略（例：単勝1号艇の購入、特定条件下での1番人気購入）で既に回収率100%を超える可能性が示されています。これは、データとアプローチの正しさを示す強力な証拠です。
2.  **改善による大きな伸びしろ**: 現在のデータ収集には「過去データの不足」と「オッズ収集間隔の粗さ」という2つの大きな課題があります。これらの課題を解決することで、回収率をさらに大幅に向上させられる見込みが非常に高いです。

プロジェクトをここで中止することは、発見した勝ち筋の可能性を放棄することに他なりません。

### 3. 課題と今後の選択肢

プロジェクトを継続し、勝ち筋を追求するために、以下の2つの課題にどう取り組むかを決定する必要があります。

#### 課題①：過去の戦歴データ（20年分）のインポート

-   **現状**: `boatrace-historical-import` ジョブは、公式サイトからのデータダウンロードが機能していない状態です。
-   **必要性**: **必要不可欠です。** 20年分のデータがあれば、AIはより多くのパターンを学習でき、季節・競艇場・選手ごとの傾向など、短期間のデータでは見えない法則性を発見できます。これにより、予測精度と回収率の飛躍的な向上が期待できます。
-   **提言**: **過去データのインポートを最優先で実施すべきです。** ダウンロードが失敗している原因（公式サイトの仕様変更など）を調査し、スクリプトを修正します。

#### 課題②：オッズの高頻度収集（10秒間隔）

-   **現状**: オッズの「歪み」を捉えるための10秒間隔収集が、RenderのCron Jobの最小実行間隔が1分であるという制約により、意図通りに機能していません。現在は1分ごとにジョブが起動し、その中でループ処理を行っているため、収集タイミングが不正確で、データが欠損しています。
-   **必要性**: **極めて重要です。** オッズの「歪み」は締切直前に発生しやすいため、締切30秒前から5秒間隔のような高頻度で正確なデータ収集ができれば、他の予想家が気づかない有利な舟券を見つけ出す強力な武器となります。
-   **提言**: **アーキテクチャを変更し、高頻度収集を実現すべきです。** 具体的には、現在のCron Job (`boatrace-odds-high-freq`) を廃止し、常時起動する**Web Service (Worker)** に変更します。このWorker内でスケジューリングライブラリ（`APScheduler`など）を用いれば、秒単位での正確な収集が可能になります。

### 4. Renderプランとコスト

ご提供いただいた情報と調査に基づき、現在の月額費用を算出しました。

| サービス名 | プラン | 月額費用（推定） | 備考 |
| :--- | :--- | :--- | :--- |
| **データベース** | | |
| `kokotomo-db-staging` | Basic 256MB | $7 | [1] |
| **データ収集ジョブ** | | |
| `boatrace-daily-collection` | Starter (Cron) | $1 | 最低料金 |
| `boatrace-odds-regular` | Starter (Cron) | $1 | 最低料金 |
| `boatrace-result-collection` | Starter (Cron) | $1 | 最低料金 |
| `boatrace-historical-import` | Starter (Cron) | $1 | 最低料金 |
| `boatrace-odds-high-freq` | Starter (Cron) | $1 | 最低料金 |
| **その他** | | |
| `ai-auto-mailer` など | Free / Starter | $0〜 | 競艇プロジェクトとは直接関係ないため除外 |
| **合計（競艇関連）** | | **約$12/月** | |

**提言（アーキテクチャ変更）に伴うコスト変動**

-   `boatrace-odds-high-freq` (Cron Job, $1/月) を廃止
-   新たに **Web Service (Worker)** を **Starterプラン ($7/月)** で追加

この変更により、月額費用は約$6増加し、**合計 約$18/月** となります。月額約2,700円（$1=150円換算）の投資で、より正確なデータに基づいた高精度なAI予想の基盤が整います。

### 5. 総合的な提言と次のステップ

以上の分析から、以下のステップでプロジェクトを推進することを強く推奨します。

1.  **プロジェクト継続を決定する。**
2.  **Renderのアーキテクチャを変更する。**
    *   `boatrace-odds-high-freq` (Cron Job) を停止・削除する。
    *   オッズ高頻度収集用の **Web Service (Worker)** を新規に作成し、デプロイする。（締切30秒前から5秒間隔での収集を実装）
3.  **過去データインポートを再開する。**
    *   `boatrace-historical-import` のダウンロード失敗原因を調査し、スクリプトを修正・実行する。
4.  **新データでAIモデルを再学習・評価する。**
    *   蓄積された20年分のデータと、高頻度収集したオッズデータを活用し、新たなAI予想モデルを構築・評価する。

この手順を踏むことで、当初の目的であった「AIによる競艇予想」の実現可能性が大幅に高まり、投資回収も十分に視野に入ると考えられます。

---

### 参考文献
[1] Render. "Pricing". Render.com. 参照日: 2026-01-10. <https://render.com/pricing>
